<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Hợp đồng kiểm toán A210</title>
  
  <!-- CSS tương tự như trong contract_template.html -->
  
  <!-- Thêm các thư viện cần thiết -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/docxtemplater/3.28.6/docxtemplater.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pizzip/3.1.1/pizzip.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
  <script src="https://unpkg.com/pizzip/dist/pizzip-utils.js"></script>
</head>
<body>
  <div class="container" id="content">
    <!-- Nội dung hợp đồng sẽ được điền ở đây -->
    <div id="loading">Đang tải dữ liệu hợp đồng...</div>
  </div>
  
  <div class="button-container">
    <button onclick="exportToWord()" id="exportButton" disabled>Xuất Word</button>
    <button onclick="viewWordTemplate()">Xem mẫu Word</button>
  </div>
  
  <script>
    // Biến lưu trữ dữ liệu hợp đồng
    let contractData = {};
    
    // Hàm lấy tham số từ URL
    function getParameterByName(name) {
      const url = window.location.href;
      name = name.replace(/[\[\]]/g, '\\$&');
      const regex = new RegExp('[?&]' + name + '(=([^&#]*)|&|#|$)');
      const results = regex.exec(url);
      if (!results) return null;
      if (!results[2]) return '';
      return decodeURIComponent(results[2].replace(/\+/g, ' '));
    }
    
    // Hàm tải dữ liệu hợp đồng từ API
    async function loadContractData() {
      const idHopDong = getParameterByName('ID_HopDong');
      
      if (!idHopDong) {
        document.getElementById('loading').innerHTML = 'Lỗi: Thiếu tham số ID_HopDong';
        return;
      }
      
      try {
        const response = await fetch(`https://script.google.com/macros/s/YOUR_SCRIPT_ID/exec
